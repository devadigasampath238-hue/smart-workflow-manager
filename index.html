<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Smart Workflow Manager</title>
<link rel="stylesheet" href="style.css">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
</head>

<body>

<div class="container">

    <!-- Sidebar -->
    <div class="sidebar">
        <h2>‚ö° Workflow</h2>
        <ul>
            <li onclick="showPage('dashboard')">Dashboard</li>
            <li onclick="showPage('board')">Board</li>
            <li onclick="showPage('login')">Login</li>
            <li onclick="toggleDark()">üåô Dark Mode</li>
        </ul>
    </div>

    <!-- Main -->
    <div class="main">

        <!-- DASHBOARD -->
        <section id="dashboard">
            <h1>Dashboard</h1>

            <div class="cards">
                <div class="card">
                    <h3>Total Tasks</h3>
                    <p id="totalTasks">0</p>
                </div>
                <div class="card">
                    <h3>Completed</h3>
                    <p>0</p>
                </div>
                <div class="card">
                    <h3>Pending</h3>
                    <p>0</p>
                </div>
            </div>

            <div class="tasks">
                <h2>Task Manager</h2>

                <input id="taskInput" type="text" placeholder="Enter new task">
                <button onclick="addTask()">Add Task</button>

                <ul id="taskList"></ul>
            </div>
        </section>

        <!-- BOARD -->
        <section id="board" style="display:none;">
            <h1>Project Board</h1>
            <div class="board">
                <div class="column">
                    <h3>To Do</h3>
                    <p>Design homepage</p>
                </div>
                <div class="column">
                    <h3>In Progress</h3>
                    <p>Build dashboard</p>
                </div>
                <div class="column">
                    <h3>Done</h3>
                    <p>Project setup</p>
                </div>
            </div>
        </section>

        <!-- LOGIN -->
        <section id="login" style="display:none;">
            <h1>Login</h1>
            <div class="login-box">
                <input type="text" placeholder="Username">
                <input type="password" placeholder="Password">
                <button>Login</button>
            </div>
        </section>

    </div>
</div>

<script>
function showPage(page) {
    document.getElementById('dashboard').style.display = 'none';
    document.getElementById('board').style.display = 'none';
    document.getElementById('login').style.display = 'none';
    document.getElementById(page).style.display = 'block';
}

function toggleDark() {
    document.body.classList.toggle('dark');
}

const API = "http://localhost:5000/tasks";

async function loadTasks() {
    const res = await fetch(API);
    const tasks = await res.json();

    const list = document.getElementById("taskList");
    const total = document.getElementById("totalTasks");
    const completed = document.querySelectorAll(".card p")[1];
    const pending = document.querySelectorAll(".card p")[2];

    list.innerHTML = "";

    let completedCount = 0;

    tasks.forEach((task, index) => {
        if (task.completed) completedCount++;

        const li = document.createElement("li");
        li.innerHTML = `
            <input type="checkbox" ${task.completed ? "checked" : ""} 
                   onchange="toggleTask(${index})">
            <span style="text-decoration:${task.completed ? "line-through" : "none"}">
                ${task.text}
            </span>
            <button onclick="deleteTask(${index})">‚ùå</button>
        `;
        list.appendChild(li);
    });

    total.textContent = tasks.length;
    completed.textContent = completedCount;
    pending.textContent = tasks.length - completedCount;
}

async function addTask() {
    const input = document.getElementById("taskInput");
    const value = input.value.trim();
    if (!value) return;

    await fetch(API, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ task: value })
    });

    input.value = "";
    loadTasks();
}

async function toggleTask(index) {
    await fetch(`${API}/${index}`, { method: "PUT" });
    loadTasks();
}

async function deleteTask(index) {
    await fetch(`${API}/${index}`, { method: "DELETE" });
    loadTasks();
}

loadTasks();
</script>


</body>
</html>
